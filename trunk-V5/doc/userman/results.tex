%%  -*- mode: latex; mode: outline-minor; fill-column: 108 -*- 
%% Title:  results
%%
%% $HeadURL$
%% Original Author:     Greg Franks <greg@sce.carleton.ca>
%% Created:             Tue Jul 18 2006
%%
%% ----------------------------------------------------------------------
%% $Id$
%% ----------------------------------------------------------------------

\chapter{Results}
\label{sec:results}

Both the analytic solver and the simulator calculate:
\begin{itemize}
\item throughput bounds (lqns only)\index{throughput!bounds},
\item mean delay for rendezvous\index{queueing delay!task} and
  send-no-reply requests,
\item variances for the rendezvous and send-no-reply request delays
  (lqsim only),
\item mean delay for joins\index{join!delay},
\item entry service times and variances\index{service time},
\item distributions for the service time\index{service time!distribution}\marginpar{lqsim}
\item task throughputs\index{throughput} and
  utilizations\index{utilization!task},
\item processor utilizations\index{utilization!processor}  and
  queueing delays\index{queueing delay!processor}.
\end{itemize}
Figure~\ref{fig:results} shows some of these results for the model
shown in Figure~\ref{fig:bookstore}, after solving the model
analytically using \manpage{lqns}{1}.  The interpretation of these
results are describe below in Section~\ref{sec:model-results}.

\begin{figure}[htbp]
  \centering
  \epsffile{bookstore/bookstore-result.eps}
  \caption{Results.}
  \label{fig:results}
\end{figure}

Results can be saved in three different formats:
\begin{enumerate}
\item in a human-readable form.
\item in a ``parseable''\index{output!parseable} form suitable for
  processing by other programs.  The grammar for the parseable output
  is described in Section \ref{sec:old-grammar} on
  page~\pageref{sec:old-grammar}.
\item in XML\index{output!XML} (again suitable for by processing by
  other programs).  The schema for the XML output is shown in
  Section~\ref{sec:xml-grammar} on page~\pageref{sec:xml-grammar}.
\end{enumerate}
If input to the solver is in XML\index{input!XML}, then output will be
in XML.  Human-readable output\index{output!human readable} will be
produced by default except if output is redirected using the
\flag{o}{output} flag and either XML or parseable output is being
generated.  Conversion\index{output!conversion} from parseable output
to XML, and from either parseable or XML output to the human-readable
form, can be accomplished using \manpage{lqn2ps}{1}.

\section{Header}

The human-readable output from the the analytic solver and simulator
consists of three parts.  Part 1 of the output consists of solution
statistics and other header information and is described in detail in
Sections~\ref{sec:analytic-header-out} and
\ref{sec:simulator-header-out} below.  Part 2 of the output lists the
input and is not described further.  Part 3 contains the actual
results.  These results are described in
Section~\ref{sec:model-results}, starting on
page~\pageref{sec:model-results}.  The section headings here
correspond to the section headings in the output file.

\subsection{Analytic Solver (lqns)}
\label{sec:analytic-header-out}

Figure~\ref{fig:output-lqns} shows the header information output by
the analytic solver.  The first line of the output shows the version
of the solver and where it was run.  This information is often useful
when reporting problems with the solver.  The lines labeled
\texttt{Input} and \texttt{Output} are the input and output file names
respectively.  The line labelled \texttt{Command line} shows all the
arguments used to invoke the solver.  The \texttt{Comment} field
contains the information found in the comment field of the general
information field of the input file (c.f.~\S\ref{sec:general-in},
\S\ref{sec:LqnModelType}).  Next, optionally, the output lists any
pragma used.  Much of this information is also present if the
simulator is used to solve the model.  The remainder of the header
lists statistics accumulated during the solution of the model and is
solver-specific.

\begin{sidewaysfigure}
  \centering
  \small
  \begin{verbatim}
Generated by lqns, version 3.9 (Darwin 6.8.Darwin Kernel Version 6.8: Wed Sep 10 15:20:55 PDT 2003;  Power Macintosh)

Copyright the Real-Time and Distributed Systems Group,
Department of Systems and Computer Engineering
Carleton University, Ottawa, Ontario, Canada. K1S 5B6

Input:  bookstore.lqn
Output: bookstore.out
Command line: lqns -p
Tue Nov  1 21:37:54 2005

Comment: lqn2fig -Lg bookstore.lqn

    #pragma multiserver          = conway

Convergence test value: 7.51226e-07
Number of iterations:   5

MVA solver information: 
Submdl  n   k srv   step()     mean    stddev     wait()     mean    stddev        User      System     Elapsed   
1       5   2   4       44      8.8    1.4697       4776    955.2    299.82  0:00:00.01  0:00:00.00  0:00:00.00 
2       9   1   1       51   5.6667   0.94281        594       66    22.627  0:00:00.00  0:00:00.00  0:00:00.00 
3       9   8   3      240   26.667    9.4751 4.0365e+05    44850     32163  0:00:00.19  0:00:00.00  0:00:00.21 
4       9  10   3      271   30.111    7.0623 7.7481e+05    86090     40554  0:00:01.15  0:00:00.00  0:00:01.19 
5       9   2   1       70   7.7778    1.6178       3408   378.67    181.73  0:00:00.00  0:00:00.00  0:00:00.00 
6       5   0   0        0        0         0          0        0         0  0:00:00.00  0:00:00.00  0:00:00.00 
Total  46   0   0      676   14.696    12.464 1.1872e+06    25809     41253  0:00:01.35  0:00:00.00  0:00:01.40 

    greg-frankss-Computer.local. Darwin 6.8
    User:     0:00:01.35
    System:   0:00:00.00
    Elapsed:  0:00:01.40
\end{verbatim}
  \caption{Analytic Solver Status Output.}
  \label{fig:output-lqns}
\end{sidewaysfigure}

\begin{description}
\item[\texttt{convergence test value:}] The \texttt{convergence test
    value}\index{convergence!test value} is the root of the mean of
  the squares of the difference in the utilization of all of the
  servers from the last two iterations of the solver.  If this value
  is less than the \texttt{convergence value}
  (c.f.~\S\ref{sec:LqnModelType}, \ref{sec:general-in}) specified in
  the input file, then the results are considered
  valid\index{results!valid}.
\item[\texttt{number of iterations:}] The \texttt{number of
    iterations}\index{number of iterations} shows the number of times
  the solver has performed its ``outer iteration''.  If the number of
  iterations exceeds the iteration limit\index{iteration limit} set by
  the model file, the results are considered invalid.
\item[\texttt{MVA solver information:}] This table shows the amount of
  effort the solver expended solving each submodel.  The first column
  lists the submodel number.  Next, the column labelled `n' indicates
  the number of times the MVA solver was run on the submodel.  The
  columns labelled `k' and `srv' show the number of
  chains\index{chain} and servers in the submodel respectively.  The
  next three columns show the number of times the core MVA
  \texttt{step()}\index{step()@\texttt{step()}} function was called.
  The following three columns show the number of time the
  \texttt{wait()}\index{wait()@\texttt{wait()}} function, responsible
  for computing the queueing delay at a server, is called.  Finally,
  the last three columns list the time the solver spends solving each
  submodel.
\end{description}
Finally, the solver lists the name of the machine the it was run on,
the time spent executing the solver code, the time spent by the system
on behalf of lqns, and the total elapsed time.

\subsection{Simulator (lqsim)}
\label{sec:simulator-header-out}

Figure~\ref{fig:output-lqsim} shows the header information output by
the simulator after execution is completed.  The first line of the
output shows the version of the simulator and where it was run.  The
lines labeled \texttt{Input} and \texttt{Output} are the input and
output file names respectively.  The \texttt{Comment} field contains
the information found in the comment field of the general information
field of the input file (c.f.~\S\ref{sec:general-in},
\S\ref{sec:LqnModelType}).  Next, optionally, the output lists
any pragma used.  The remainder of the header lists statistics
accumulated during the solution of the model and is specific to the
simulator.

\begin{figure}[htbp]
  \centering
  \begin{verbatim}
Generated by lqsim, version 3.9 (Linux 2.4.20-31.9  i686),

Copyright the Real-Time and Distributed Systems Group,
Department of Systems and Computer Engineering,
Carleton University, Ottawa, Ontario, Canada. K1S 5B6

Wed Nov  2 11:42:25 2005

Input: bookstore.lqn
Output: bookstore.out
Comment: lqn2fig -Lg bookstore.lqn


Run time: 4.34765E+09
Number of Statistical Blocks: 15
Run time per block: 2.89651E+08
Max confidence interval: 7.32
Seed Value: 1130948006

    epsilon-13.sce.carleton.ca Linux 2.4.20-31.9
    User:     0:04:47.78
    System:   0:00:00.07
    Elapsed:  0:14:27.66
\end{verbatim}
  \caption{Simulator Status Output.}
  \label{fig:output-lqsim}
\end{figure}

\begin{description}
\item[\texttt{Run time:}] The total run time in simulation time units.
\item[\texttt{Number of Statistical Blocks:}] The number of
  statistical blocks\index{block!simulation} collected (when producing
  confidence intervals).  
\item[\texttt{Run time per block:}] The run time in simulation units
  per block.  This value, multiplied by the number of statistical
  blocks and the initial skip period will total to the run time.
\item[\texttt{Seed Value:}] The seed used by simulator.  
\end{description}
Finally, the simulator lists the name of the machine that it was run
on, the time spent executing the simulator code, the time spent by the
system on behalf of lqsim, and the total elapsed time.

\label{sec:model-results}

\section{Type 1 Throughput Bounds}\marginpar{lqns}
\label{sec:bounds-out}\index{throughput!bounds|textbf}

The \emph{Type 1 Throughput Bounds} are the ``guaranteed not to
exceed'' throughputs for the entries listed.  The value is calculated
assuming that there is no contention
delay\index{contention delay}\index{delay!contention} to underlying
servers.

\section{Mean Delay for a Rendezvous}
\label{sec:rendezvous-delay-out}\index{rendezvous!delay|textbf}

The \emph{Mean Delay for a Rendezvous} is the queueing
time\index{queueing time} for a request from a client to a server.  It
does not include the time the customer spends at the server (see
Figure~\ref{fig:service-time}).  To find the \emph{residence
  time}\emph{residence time}, add the queueing time to the \emph{phase
  one service time}\index{service time!phase one} of the request's
server.

\section{Variance of Delay for a Rendezvous}\marginpar{lqsim}
\label{sec:rendezvous-variance-out}\index{rendezvous!variance|textbf}

The \emph{Variance of Delay for a Rendezvous} is the variance of the
queueing time\index{queueing time!variance} for a request from a
client to the server.  It does not include the variance of the time
the customer spends at the server (see Figure~\ref{fig:service-time}).
This result is only available from the simulator.

\section{Mean Delay for a Send-No-Reply Request}
\label{sec:snr-delay-out}\index{send-no-reply!delay|textbf}

The \emph{Mean delay for a send-no-reply request} is the time the
request spends in queue and in service in phase one at the
destination.  Phase two is treated as a `vacation' at the server.

\section{Variance of Delay for a Send-No-Reply Request}\marginpar{lqsim}
\label{sec:snr-variance-out}\index{send-no-reply!variance|textbf}

\section{Arrival Loss Probabilities}
\label{sec:arrival-loss}\index{send-no-reply!loss probability|textbf}

The \emph{Arrival Loss Probabilities}\index{arrival loss probabilities}...

\section{Mean Delay for a Join}
\label{sec:join-delay-out}\index{join!delay|textbf}

The \emph{Mean Delay for a Join}\index{join} is the maximum of the sum
of the service times for each branch of a fork.  The source activity
listed in the output file is the first activity prior to the fork
(e.g., AFBA112 in Figure~\ref{fig:results}).  Similarly, the
destination activity listed in the output file is the first activity
after the join (AJA131).  The variance of the join
time\index{join!variance} is also computed.


\begin{figure}[htbp]
  \centering
  \epsffile{timing-diagrams/join-time.eps}
  \caption{Service Time Components for Join.}
  \label{fig:service-time}
\end{figure}

\section{Service Times}
\label{sec:service-time-out}\index{service time|(textbf}

The \emph{service time} is the total time a phase\index{phase!service
  time} or activity\index{activity!service time} uses processing a
request.  The time consists of four components, shown in
Figure~\ref{fig:service-time}:
\begin{enumerate}
\item Queueing for the processor\index{processor!queueing} (shown as
  items 1, 4, 6 and 8 in Figure~\ref{fig:results-service-time}.(b)).
\item Service at the processor (items 2, 5 and 9)
\item Queueing for serving tasks (item 6), and
\item Phase one service time\index{service time!phase one} at serving
  tasks (items 3 and 7).
\end{enumerate}
Queuing at processors and tasks and can occur because of contention
from other tasks (items 1, 6, and 8), or from second phases from
previous requests.  For example, entry SE3 is queued at the processor
because the processor is servicing the second phase of entry SCE3.

\begin{figure}[htbp]
  \centering
  \epsffile{timing-diagrams/service-time.eps}
  \caption{Service Time Components for Entry `SCE3'.}
  \label{fig:results-service-time}
\end{figure}

Using the results shown in Figure~\ref{fig:results}, the
service time for entry SE3 ($21.7$) is the sum of:
\begin{itemize}
\item the processor wait ($0.767$),
\item it's own service time ($6\times 10^{-6}$),
\item the queueing time to entry SCE3 ($0$),
\item the phase one service time at entry SCE3 ($11.6$),
\item the queueing time to entry CE1 ($3.83\times 10^{-10}$), and
\item the phase one service time at entry CE1 ($10$)
\end{itemize}

Queueing time for serving tasks is shown in the \emph{Mean Delay for a
  Rendezvous} section of the output.  (c.f.
\S\ref{sec:rendezvous-delay-out}).  Queueing time for the processor is
shown in the \emph{Utilization and Waiting per Phase for Processor} of
the output (c.f.
\S\ref{sec:processor-wait-utilization-out}).\index{service time|)}

\section{Service Time Variance}
\label{sec:service-time-variance-out}\index{service time!variance|textbf}

The \emph{Service Time
  Variance}\index{service time!variance}\index{variance!service time}
section lists the variance of the service time
(c.f.~\S\ref{sec:service-time-out}) for the phases and activities in
the model.

\section{Probability Maximum Service Time Exceeded}\marginpar{lqsim}
\label{sec:service-time-exceeded-out}\index{service time!probability exceeded|textbf}

The \emph{probability maximum service time exceeded}\index{service time!maximum exceeded} is output by the
simulator for all phases and activities with a \attribute{max-service-time}.  This result is the probability
that the service time is greater than the value specified.  In effect, it is a histogram with two bins.

\section{Service Time Distributions for Entries and Activities}\marginpar{lqsim}
\label{sec:service-time-distribution-out}\index{service time!distribution|textbf}

\emph{Service Time Distributions}\index{service time!distributions} are generated by the simulator by
setting the \attribute{service-time-distribution} parameter (c.f.~\S\ref{sec:ActivityDefBase},
\S\ref{sec:entry}, \S\ref{sec:activity}) for an entry or activity.  A histogram of \attribute{number-bins}
bins between \attribute{min} and \attribute{max} is generated.  Samples that fall either under or over this
range are stored in their own under-flow\index{histogram!underflow} or over-flow\index{histogram!overflow}
bins respectively.  The optional \attribute{x-samples} parameter can be used to set the sampling behaviour
to one of:
\begin{description}
\item[linear] Each bin is of equal width, found by dividing the histogram range by the number of bins.  If
  the \attribute{x-samples} is not set, this behaviour is the default.
\item[log] The logarithm of the range specified is divided by \attribute{number-bins}.  This has the effect
  of making the width of the bins small near \attribute{min}, and large near \attribute{max}.  A minimum
  value of zero is \textbf{not} allowed.
\item[sqrt] The square root of the range specified is divided by \attribute{number-bins}.  Bins are smallest
  near \attribute{bin} are smaller than those near \attribute{max}.
\end{description}

The results of the histogram collection, shown in Figure~\ref{fig:histogram}, consist of the
mean\index{service time!mean}, standard deviation,\index{service time!standard deviation},
skew\index{service time!skew} and kurtosis\index{service time!kurtosis} of the sampled range, followed by
the histogram itself.  Each entry of the histogram contains the probability of the sample falling within the
bucket, and, if available, the confidence intervals of the sample.

\begin{sidewaysfigure}
\begin{verbatim}
Service time distributions for entries and activities:

SCE3             PHASE 1: 
    Mean =   11.58, Stddev =   8.457, Skew =  0.8501, Kurtosis = -0.2496
       Begin      End       Prob.      +/-95%     +/-99%
           0        1  0.03355     0.001048   0.001412   |          *
           1        2  0.03786     0.001605   0.002163   |            *
           2        3  0.05406     0.002026   0.002731   |                 *
           3        4  0.06333     0.002031   0.002737   |                   *
           4        5  0.06545     0.001631   0.002199   |                    *
           5        6  0.06369     0.001578   0.002127   |                   *
           6        7  0.06049     0.001692   0.00228    |                  *
           7        8  0.05591     0.001822   0.002456   |                 *
           8        9  0.05133     0.001272   0.001714   |                *
           9       10  0.0472      0.001767   0.002382   |              *
          10       11  0.04318     0.001618   0.002181   |             *
          11       12  0.03931     0.001185   0.001597   |            *
          12       13  0.03579     0.001073   0.001446   |           *
          13       14  0.03231     0.001654   0.002229   |          *
          14       15  0.02952     0.001033   0.001392   |         *
          15       16  0.02677     0.001189   0.001603   |        *
          16       17  0.0243      0.001058   0.001425   |       *
          17       18  0.02214     0.001087   0.001466   |       *
          18       19  0.02001     0.001122   0.001512   |      *
          19       20  0.01806     0.001016   0.001369   |      *
          20       21  0.01653     0.0009079  0.001224   |     *
          21       22  0.01499     0.001018   0.001372   |     *
          22       23  0.01365     0.0007152  0.0009639  |    *
          23       24  0.01229     0.000955   0.001287   |    *
          24       25  0.0112      0.0008691  0.001171   |   *
          25       26  0.009997    0.0006182  0.0008331  |   *
          26       27  0.009227    0.0007344  0.0009898  |   *
          27       28  0.008282    0.0006896  0.0009293  |   *
          28       29  0.007444    0.0005936  0.0007999  |  *
          29       30  0.006802    0.0005752  0.0007751  |  *
             overflow  0.06532     0.001561   0.002104   | *
\end{verbatim}
  \caption{Histogram output}
  \label{fig:histogram}
\end{sidewaysfigure}

The statistics for the histogram\index{histogram!statistics} are found by multiplying the mid-point of the
range defined by \texttt{begin} and \texttt{end}, not counting either the overflow or underflow bins.  If
the mean value reported by the histogram is substantially different than the actual service time of the
phase or activity, then the range of the histogram is not sufficiently large.

\section{Semaphore Holding Times}
\label{sec:semaphore-holding}\index{utilization!semaphore|textbf}

The \emph{Semaphore Holding Times} section lists the average time a semaphore\index{semaphore!service time}
token is held (it's service time), the variance of the holding time, and the utilization of
semaphore\index{semaphore!utilization}\index{utilization!semaphore}.  Figure~\ref{fig:semaphore-stats} shows
how these values are found.

\begin{figure}
  \centering
  \epsffile{timing-diagrams/holding-time.eps}
  \caption{Time components of a semaphore task.}
  \label{fig:semaphore-stats}
\end{figure}

\section{Throughputs and Utilizations per Phase}
\label{sec:througput-utilization-out}\index{throughput|textbf}\index{utilization!task|textbf}

The \emph{Throughputs and Utilizations per Phase} section lists the
throughput by entry and activity, and the utilization by phase and
activity. The utilization is the \emph{task utilization}, i.e., the
reciprocal of the service time\index{service time} for the task
(c.f.~\ref{sec:service-time-out}).  The processor
utilization\index{utilization!processor}\index{processor!utilization} for the task is listed under
\emph{Utilization and Waiting per Phase for Processor}
(see~\S\ref{sec:processor-wait-utilization-out}).

\section{Arrival Rates and Waiting Times}
\label{sec:open-wait-out}\index{open arrival!waiting time|textbf}\index{waiting time!open arrival|textbf}

The \emph{Arrival Rates and Waiting Times} section is only present in
the output when \emph{open arrivals} are present in the input.  This
section shows the arrival rate (\emph{Lambda}\index{lambda}) and the
waiting time\index{waiting time}.  The waiting time includes the
service time at the task.

\section{Utilization and Waiting per Phase for Processor}
\label{sec:processor-wait-utilization-out}\index{utilization!processor|textbf}\index{queueing time!processor|textbf}

The \emph{Utilization and Waiting per Phase for Processor} lists the
processor utilization and the queueing time for every entry and
activity running on the processor.


%%% Local Variables: 
%%% mode: latex
%%% mode: outline-minor 
%%% fill-column: 108
%%% TeX-master: "userman"
%%% TeX-master: "userman"
%%% End: 
